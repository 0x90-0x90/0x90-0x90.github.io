---
layout: post
title: Exploiting Electron RCE in Exodus wallet
canonical_url: https://medium.com/hackernoon/exploiting-electron-rce-in-exodus-wallet-d9e6db13c374?source=rss-6916f6b61f10------2
tag:
- vulnerability
- exploiting-electron-rce
- javascript
- cryptocurrency
- electron
---

<p>While browsing Twitter I’ve noticed <a href="https://electronjs.org/blog/protocol-handler-fix">ElectronJS remote code execution vulnerability</a> in protocol handler. That sounds severe. As stated in official description, for application to be vulnerable is enough to register itself as default handler for some protocol. I had one application based on Electron installed on my laptop that I was looking into some time ago — <a href="https://www.exodus.io/">Exodus</a> cryptocurrencies wallet. I knew that it registers itself as a handler for <em>exodus://</em> URI scheme.</p><p>Since no details about vulnerability were presented on the official blog post, I went straight to electron <a href="https://github.com/electron/electron">Github</a> looking for recent commits. The following <a href="https://github.com/electron/electron/commit/c49cb29ddf3368daf279bd60c007f9c015bc834c">commit</a> was a fix for vulnerability. Biggest change was a newly created file <em>command_line_args.cc</em> which implements few check for command line arguments.</p><p><a href="https://github.com/electron/electron/blob/c49cb29ddf3368daf279bd60c007f9c015bc834c/atom/app/command_line_args.cc">electron/electron</a></p><p>Basically, the code checks command line arguments against a blacklist. Based on that, it can be assumed that it is possible to inject command line arguments via URI handler<strong>.</strong> Electron based applications are basically bunch of Javascript and HTML files rendered by Chromium for front-end and nodejs for back-end. And Chromium and nodejs is bundled inside main executable file. Those strings of blacklist in fix commit is command line switches for Chromium and nodejs. Seems that to exploit vulnerability we only need to find command line option in Chromium or nodejs that allows to spawn additional process.</p><p>To test if it is really possible to inject arguments to Exodus.exe via protocol I created HTML file:</p><pre>&lt;!doctype html&gt;<br>&lt;script&gt;<br>  window.location = &#39;exodus://aaaaaaaaa --aaaaa=&#39;<br>&lt;/script&gt;</pre><p>Exodus wallet was launched with the following arguments.</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/566/1*hHEVvAQpHDfnMYztwcSG8A.png" /></figure><p>Payload was wrapped with double quotes. Nevertheless, double quote was not filtered out or sanitized before passing as command line arguments. The following allowed to inject additional command line switch.</p><pre>&lt;!doctype html&gt;<br>&lt;script&gt;<br>  window.location = &#39;exodus://aaaaaaaaa&quot; --aaaaa=bbbb&#39;<br>&lt;/script&gt;</pre><figure><img alt="" src="https://cdn-images-1.medium.com/max/599/1*4Wscx_MYasAVLIy6BP8Jug.png" /></figure><p>For remote code execution it is needed to find nice Chromium command line switch that allows to execute additional command. I found <a href="https://peter.sh/experiments/chromium-command-line-switches/">page</a> containing nicely summarized list of Chromium command line switches. <em>gpu-launcher</em> looked promising.</p><blockquote>— gpu-launcher Extra command line options for launching the GPU process (normally used for debugging). Use like renderer-cmd-prefix.</blockquote><p>Time to try it.</p><pre>&lt;!doctype html&gt;<br>&lt;script&gt;<br>  window.location = &#39;exodus://aaaaaaaaa&quot; --gpu-launcher=&quot;cmd&quot; --aaaaa=&#39;<br>&lt;/script&gt;</pre><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*_NysdNRGficVDHykofA33Q.gif" /></figure><p>Exodus wallet was quick to release an update, it was released shortly after announcement of vulnerability. Also, it does a good job by pushing an update for end users by displaying messages, nevertheless update is not automatic and user still has to confirm an update. Anyway, there is ton of desktop applications based on Electron, so better check if any app running on your machine is based on Electron and make sure it is patched.</p><img src="https://medium.com/_/stat?event=post.clientViewed&referrerSource=full_rss&postId=d9e6db13c374" width="1" height="1" alt=""><hr><p><a href="https://medium.com/hackernoon/exploiting-electron-rce-in-exodus-wallet-d9e6db13c374">Exploiting Electron RCE in Exodus wallet</a> was originally published in <a href="https://medium.com/hackernoon">HackerNoon.com</a> on Medium, where people are continuing the conversation by highlighting and responding to this story.</p>
